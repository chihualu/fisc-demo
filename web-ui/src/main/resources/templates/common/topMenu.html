<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <style id="antiClickjack">body {
        display: none !important;
    }</style>
    <script>
        if (self === top) {
            var antiClickjack = document.getElementById("antiClickjack");
            antiClickjack.parentNode.removeChild(antiClickjack);
        }
    </script>
</head>
<body>
<th:block th:fragment="topMenu">
    <nav class="navbar navbar-expand-lg navbar-fixed-top navbar-dark bg-primary">
        <a class="sr-only sr-only-focusable text-light " href="#C" id="shortStart" tabindex="1" title="跳到主要內容區塊">跳到主要內容區塊</a>
        <a class="navbar-brand" th:href="@{/index}" th:title="#{title.global}" th:utext="#{title.global}"></a>
        <a accesskey="U" class="accesskey u text-light " href="#U" id="startPoint" name="U" title="上方快速連結導覽區(alt+u)">:::</a>
        <button aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler"
                data-target="#navbarContent" data-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav mr-auto" >
                <li class="nav-item dropdown" >
                    <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="maintain" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span th:utext="#{function.maintain.title}"></span></a>
                    <ul class="dropdown-menu" th:aria-labelledby="'maintain'">
                        <li >
                            <a class="dropdown-item"  href="#" th:onclick="redirectPage([[@{'/web/maintain/fiscNotice'}]])" ><span th:utext="#{function.maintain.fisc-notice.title}"></span></a>
                        </li>
                    </ul>
                </li>
            </ul>

            <form id="logoutForm" class="form-inline my-2 my-lg-0 d-flex align-items-end" method="POST" th:action="@{'/logout'}" >

                <div class="dropdown dropleft px-2">
                    <a class="text-light dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-user-cog"></i>
                    </a>

                </div>
                <input type="hidden" id="_loginUrl" th:value="@{/login}">
                <button class="btn btn-outline-light btn-sm px-4" type="button" onclick="logout()">登出</button>
            </form>
        </div>
    </nav>
    <script th:inline="javascript">
        function logout(){
            onLoading();
            // db login
            $.ajax({
                type: 'POST',
                url: $('#logoutForm').attr('action'),
                data: getFormData($('#logoutForm')),
                complete: function (XMLHttpRequest, textStatus){
                    completeLoading();
                    Swal.fire({
                        icon: "success",
                        title: '登出成功，轉頁中...',
                        timer: 1000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    }).then((result) => {
                        document.location.href = $('#_loginUrl').val();
                        onLoading();
                    })
                }
            });
        }
    </script>
</th:block>
</body>